<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Encuadre: Fisiopatolog√≠a</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      margin: 0;
      padding: 20px;
      color: #333;
      min-height: 100vh;
      overflow-x: hidden;
    }
    h1 {
      color: #fff;
      text-align: center;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.6);
    }
    .subtitle {
      color: #ddd;
      text-align: center;
      max-width: 800px;
      margin: 10px auto 30px;
      font-size: 1.1em;
    }

    #board-container {
      position: relative;
      width: 100%;
      margin: 40px auto;
    }

    /* --- ESPACIO PARA EL ESPIRAL (PC) --- */
    .spiral-container {
      width: 800px;
      height: 800px;
      margin: 60px auto;
      position: relative;
    }
    .tile-spiral {
      position: absolute;
      width: 90px;
      height: 90px;
    }

    /* --- CAMINO VERTICAL (M√ìVIL) --- */
    .mobile-path {
      display: none;
      max-width: 400px;
      margin: 0 auto;
    }
    .mobile-path.active {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      padding: 20px 0;
    }
    .tile-mobile {
      width: 100%;
      max-width: 360px;
      height: 80px;
      background: #005b96;
      color: white;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
      text-align: center;
      padding: 8px;
    }
    .tile-mobile i {
      font-size: 16px;
    }
    .tile-mobile.locked {
      background: #555;
      opacity: 0.6;
      cursor: not-allowed;
    }
    .tile-mobile.completed {
      background: #2e8b57;
    }
    .tile-mobile.unit {
      background: #003366;
      font-weight: bold;
      font-size: 13px;
    }

    /* Estilos comunes */
    .tile-spiral, .tile-mobile {
      border-radius: 12px;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .tile-spiral:hover, .tile-mobile:hover:not(.locked) {
      transform: scale(1.1);
      box-shadow: 0 10px 20px rgba(0,0,0,0.4);
    }
    .tile-spiral i, .tile-mobile i {
      font-size: 18px;
      margin-bottom: 4px;
    }
    .tile-spiral strong, .tile-mobile strong {
      font-size: 12px;
    }
    .tile-spiral span, .tile-mobile span {
      font-size: 10px;
    }

    /* Meta final */
    .center-goal, .final-goal {
      background: #d4af37;
      color: #000;
      font-weight: bold;
      animation: pulse 2s infinite;
      z-index: 20;
    }
    .center-goal {
      position: absolute;
      width: 110px;
      height: 110px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 25px rgba(212, 175, 55, 0.8);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    .final-goal {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      max-width: 360px;
      height: 100px;
      border-radius: 16px;
      margin: 20px auto;
      box-shadow: 0 0 25px rgba(212, 175, 55, 0.8);
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 25px rgba(212, 175, 55, 0.8); }
      50% { box-shadow: 0 0 40px rgba(212, 175, 55, 1); }
      100% { box-shadow: 0 0 25px rgba(212, 175, 55, 0.8); }
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      overflow-y: auto;
    }
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 18px;
      width: 90%;
      max-width: 700px;
      text-align: left;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      max-height: 90vh;
      overflow-y: auto;
    }
    .close {
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      color: #aaa;
    }
    .close:hover {
      color: #000;
    }
    .topic-list {
      margin: 15px 0;
      padding-left: 20px;
    }
    .topic-list li {
      margin: 8px 0;
      line-height: 1.5;
    }
    .btn-next, .btn-contract, .btn-print {
      background: #005b96;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin: 10px 5px;
      text-decoration: none;
      display: inline-block;
    }
    .btn-contract {
      background: #d4af37;
      color: #000;
    }
    .btn-print {
      background: #2e8b57;
    }
    .btn-next:hover, .btn-contract:hover, .btn-print:hover {
      opacity: 0.9;
    }

    /* Contrato Modal */
    .contract-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
      z-index: 2000;
      overflow-y: auto;
    }
    .contract-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 800px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .signature-area {
      border: 2px dashed #005b96;
      height: 100px;
      margin: 20px 0;
      position: relative;
      background: #f9f9f9;
    }
    .clear-signature {
      font-size: 12px;
      cursor: pointer;
      color: #005b96;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <h1 id="title">üåÄ Encuadre: Fisiopatolog√≠a</h1>
  <p class="subtitle">Bienvenido al curso de Fisiopatolog√≠a (Tercer semestre). Este tablero te gu√≠a por las unidades tem√°ticas del programa. Avanza y conoce lo que aprender√°s.</p>

  <div id="board-container"></div>

  <!-- Modal -->
  <div class="modal" id="infoModal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle"></h2>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- Modal del Contrato -->
  <div class="contract-modal" id="contractModal">
    <div class="contract-content" id="contractPrintArea">
      <h2 style="text-align: center;">üìú Contrato de Compromiso del Estudiante</h2>
      <p style="text-align: center;"><em>Unidad de Aprendizaje: Fisiopatolog√≠a</em></p>
      <br>
      <p>Yo, <strong id="cNombre">_________________________</strong>, matr√≠cula <span id="cMatricula">__________</span>, estudiante del <span id="cGrado">_______</span>, grupo <span id="cGrupo">___</span>, declaro bajo protesta de decir verdad que:</p>
      <br>
      <ol>
        <li>He le√≠do y comprendido el <strong>programa de estudio y encuadre</strong> de la unidad de aprendizaje de Fisiopatolog√≠a.</li>
        <li>Conozco las <strong>competencias</strong>, <strong>unidades tem√°ticas</strong>, <strong>actividades</strong> y <strong>criterios de evaluaci√≥n</strong> del curso.</li>
        <li>Me comprometo a participar activamente, cumplir con las actividades y respetar el proceso ense√±anza-aprendizaje.</li>
        <li>Entiendo que el uso de TICs, el trabajo colaborativo y la √©tica acad√©mica son fundamentales en este curso.</li>
      </ol>
      <br>
      <p>Por lo tanto, firmo el presente documento como acto de compromiso con mi formaci√≥n biom√©dica.</p>
      <br>
      <p><strong>Lugar y fecha:</strong> Culiac√°n, Sinaloa, a <span id="cFecha">_______</span></p>
      <br>
      <p><strong>Firma del estudiante:</strong></p>
      <div class="signature-area" id="signature-pad"></div>
      <p class="clear-signature" onclick="clearSignature()">Borrar firma</p>
      <p style="font-size: 12px; color: #555;">(Firma realizada de forma digital)</p>
      <br>
      <p><strong>Nombre:</strong> <span id="cNombre2">_________________________</span></p>
      <p><strong>Matr√≠cula:</strong> <span id="cMatricula2">__________</span></p>
      <p><strong>Grado y grupo:</strong> <span id="cGradoGrupo">_______, grupo ___</span></p>
    </div>
    <div style="margin-top: 20px;">
      <button class="btn-print" onclick="printContract()">üñ®Ô∏è Imprimir Contrato</button>
      <button class="btn-next" onclick="closeContract()">Cerrar</button>
    </div>
  </div>

  <script>
    // Canvas para firma
    let canvas, ctx;
    let isDrawing = false;

    const tiles = [
      { id: "inicio", label: "Inicio", sub: "", type: "normal", icon: "fa-home" },
      { id: "unidad1", label: "Unidad I", sub: "Fundamentos", type: "unit", icon: "fa-book" },
      { id: "I1", label: "I.1", sub: "Introducci√≥n", type: "normal", icon: "fa-info-circle" },
      { id: "I2", label: "I.2", sub: "Bases Celulares", type: "normal", icon: "fa-dna" },
      { id: "II", label: "Unidad II", sub: "√ìrganos y Sistemas", type: "unit", icon: "fa-heartbeat" },
      { id: "II1", label: "II.1", sub: "Estudio General", type: "normal", icon: "fa-network-wired" },
      { id: "II2", label: "II.2", sub: "Marcadores", type: "normal", icon: "fa-vial" },
      { id: "III", label: "Unidad III", sub: "Enfermedades", type: "unit", icon: "fa-notes-medical" },
      { id: "III1", label: "III.1", sub: "Inmunol√≥gica", type: "normal", icon: "fa-shield-alt" },
      { id: "III2", label: "III.2", sub: "Infecciosas", type: "normal", icon: "fa-bacteria" },
      { id: "III3", label: "III.3", sub: "Metab√≥licas", type: "normal", icon: "fa-apple-alt" },
      { id: "III4", label: "III.4", sub: "Neurol√≥gicas", type: "normal", icon: "fa-brain" },
      { id: "III5", label: "III.5", sub: "Oncol√≥gicas", type: "normal", icon: "fa-radiation" },
      { id: "IV", label: "Unidad IV", sub: "Aplicaciones", type: "unit", icon: "fa-stethoscope" },
      { id: "IV1", label: "IV.1", sub: "Evaluaci√≥n", type: "normal", icon: "fa-clipboard-check" },
      { id: "IV2", label: "IV.2", sub: "Terap√©utica", type: "normal", icon: "fa-pills" },
      { id: "IV3", label: "IV.3", sub: "Prevenci√≥n", type: "normal", icon: "fa-hands-wash" },
      { id: "V", label: "Unidad V", sub: "Vanguardia", type: "unit", icon: "fa-flask" },
      { id: "V1", label: "V.1", sub: "Epigen√©tica", type: "normal", icon: "fa-gene" },
      { id: "V2", label: "V.2", sub: "Microbiota", type: "normal", icon: "fa-seedling" },
      { id: "V3", label: "V.3", sub: "Biomarcadores", type: "normal", icon: "fa-chart-line" },
      { id: "V4", label: "V.4", sub: "C√©lulas Madre", type: "normal", icon: "fa-leaf" },
      { id: "V5", label: "V.5", sub: "Inflamaci√≥n", type: "normal", icon: "fa-fire" },
      { id: "V6", label: "V.6", sub: "Neurodegeneraci√≥n", type: "normal", icon: "fa-atom" },
      { id: "V7", label: "META", sub: "Envejecimiento", type: "final", icon: "fa-hourglass-end" },
    ];

    const unlocked = { inicio: true };
    let lastUnlocked = "inicio";
    let currentMode = "";

    function detectAndRender() {
      const container = document.getElementById("board-container");
      container.innerHTML = "";

      if (window.innerWidth > 768) {
        renderSpiral();
        currentMode = "spiral";
        document.getElementById("title").textContent = "üåÄ Encuadre: Fisiopatolog√≠a";
      } else {
        renderMobilePath();
        currentMode = "mobile";
        document.getElementById("title").textContent = "üìö Fisiopatolog√≠a: Encuadre";
      }
    }

    function renderSpiral() {
      const container = document.createElement("div");
      container.className = "spiral-container";
      const centerX = 400;
      const centerY = 400;
      const radius = 350;

      tiles.forEach((tile, index) => {
        if (tile.id === "V7") return;

        const angle = (index / (tiles.length - 1)) * Math.PI * 4;
        const r = radius * (1 - index / (tiles.length + 4));
        const x = centerX + r * Math.cos(angle);
        const y = centerY + r * Math.sin(angle);

        const el = document.createElement("div");
        el.className = `tile-spiral ${tile.type === 'unit' ? 'unit' : ''} ${unlocked[tile.id] ? '' : 'locked'}`;
        el.id = `tile-${tile.id}`;
        el.onclick = () => openModal(tile.id);

        el.innerHTML = `
          <i class="fas ${tile.icon}"></i>
          <strong>${tile.label}</strong>
          <span>${tile.sub}</span>
        `;

        container.appendChild(el);
        el.style.left = `${x - 45}px`;
        el.style.top = `${y - 45}px`;
      });

      const goal = document.createElement("div");
      goal.className = `center-goal ${unlocked["V7"] ? "completed" : "locked"}`;
      goal.id = "tile-V7";
      goal.onclick = () => openModal("V7");
      goal.innerHTML = `
        <i class="fas fa-trophy"></i>
        <strong>META FINAL</strong>
        <span>V.7: Envejecimiento</span>
      `;
      container.appendChild(goal);

      document.getElementById("board-container").appendChild(container);
    }

    function renderMobilePath() {
      const container = document.createElement("div");
      container.className = "mobile-path active";

      tiles.forEach(tile => {
        const el = document.createElement("div");
        el.className = `tile-mobile ${tile.type === 'unit' ? 'unit' : ''} ${unlocked[tile.id] ? (tile.id === "V7" ? "completed" : "") : 'locked'}`;
        el.id = `tile-${tile.id}`;
        el.onclick = () => openModal(tile.id);

        el.innerHTML = `
          <i class="fas ${tile.icon}"></i>
          <strong>${tile.label}</strong>
          <span>${tile.sub}</span>
        `;

        container.appendChild(el);
      });

      const goal = document.createElement("div");
      goal.className = `final-goal ${unlocked["V7"] ? "completed" : "locked"}`;
      goal.id = "tile-V7";
      goal.onclick = () => openModal("V7");
      goal.innerHTML = `
        <i class="fas fa-trophy"></i>
        <strong>üèÜ META FINAL</strong>
        <span>V.7: Fisiopatolog√≠a del Envejecimiento</span>
      `;
      container.appendChild(goal);

      document.getElementById("board-container").appendChild(container);
    }

    function openModal(id) {
      if (!unlocked[id]) {
        alert("üîí Este tema se desbloquea tras revisar el anterior en clase.");
        return;
      }

      const modal = document.getElementById("infoModal");
      const title = document.getElementById("modalTitle");
      const body = document.getElementById("modalBody");

      switch(id) {
        case "inicio":
          title.textContent = " Bienvenido al Curso de Fisiopatolog√≠a";
          body.innerHTML = `
            <p><strong>Clave:</strong> No especificada</p>
            <p><strong>Ubicaci√≥n:</strong> Tercer semestre | √Årea: Ciencias de la Salud</p>
            <p><strong>Horas:</strong> 80 te√≥ricas + 32 pr√°cticas + 32 estudio independiente = 144 horas | <strong>Cr√©ditos:</strong> 9</p>
            <h3>üìö Competencia del curso</h3>
            <p>El estudiante desarrollar√° habilidades para comprender los mecanismos subyacentes de las enfermedades. Aprender√° a analizar los procesos patol√≥gicos a nivel celular, molecular y sist√©mico. Adem√°s, ser√° capaz de aplicar este conocimiento para identificar signos tempranos de enfermedades y proponer estrategias de prevenci√≥n y tratamiento.</p>
            <h3>üîó Unidades relacionadas</h3>
            <p>Morfolog√≠a humana, bioqu√≠mica, fisiolog√≠a, bio√©tica y bioseguridad.</p>
            <button class="btn-next" onclick="unlockNext('unidad1'); closeModal()">‚û°Ô∏è Continuar con Unidad I</button>
          `;
          break;

        case "unidad1":
          title.textContent = "Unidad I: Fundamentos de Fisiopatolog√≠a";
          body.innerHTML = `
            <p>Esta unidad establece las bases conceptuales y moleculares de la enfermedad.</p>
            <button class="btn-next" onclick="unlockNext('I1'); closeModal()">‚û°Ô∏è Ir a I.1: Introducci√≥n</button>
          `;
          break;

        case "I1":
          title.textContent = "I.1: Introducci√≥n a la Fisiopatolog√≠a desde una perspectiva biom√©dica";
          body.innerHTML = `
            <ul class="topic-list">
              <li><strong>a) Concepto de fisiopatolog√≠a:</strong> Estudio de los cambios funcionales que ocurren durante una enfermedad.</li>
              <li><strong>b) Conceptos de salud, enfermedad, patog√©nesis y etiolog√≠a:</strong> Definiciones y relaciones entre estos conceptos.</li>
              <li><strong>c) Conceptos de s√≠ntoma, signo, s√≠ndrome y otros:</strong> Diferencias y relevancia cl√≠nica.</li>
              <li><strong>d) Fisiopatolog√≠a y la medicina basada en la evidencia:</strong> Rol de la fisiopatolog√≠a en la toma de decisiones cl√≠nicas.</li>
              <li><strong>e) La fisiopatolog√≠a en la investigaci√≥n biom√©dica:</strong> Aplicaci√≥n de principios fisiopatol√≥gicos en estudios cient√≠ficos.</li>
            </ul>
            <button class="btn-next" onclick="unlockNext('I2'); closeModal()">‚û°Ô∏è Siguiente: Bases celulares</button>
          `;
          break;

        case "I2":
          title.textContent = "I.2: Bases Celulares y Moleculares de las Enfermedades";
          body.innerHTML = `
            <ul class="topic-list">
              <li><strong>a) Consideraci√≥n de la homeostasis y desequilibrios:</strong> Mecanismos que mantienen la estabilidad y su alteraci√≥n en la enfermedad.</li>
              <li><strong>b) Agentes lesivos y mecanismos de lesi√≥n:</strong> F√≠sicos, qu√≠micos, biol√≥gicos y gen√©ticos.</li>
              <li><strong>c) Mecanismos celulares de adaptaci√≥n:</strong> Hipertrofia, hiperplasia, atrofia, metaplasia.</li>
              <li><strong>d) Generalidades de los mecanismos patog√©nicos espec√≠ficos:</strong> Apoptosis, necrosis, inflamaci√≥n, disfunci√≥n metab√≥lica.</li>
            </ul>
            <button class="btn-next" onclick="unlockNext('II'); closeModal()">‚û°Ô∏è Desbloquear Unidad II</button>
          `;
          break;

        case "II":
          title.textContent = "Unidad II: √ìrganos y Sistemas en Fisiopatolog√≠a";
          body.innerHTML = `
            <p>Enfoque integrado en sistemas corporales y herramientas diagn√≥sticas.</p>
            <button class="btn-next" onclick="unlockNext('II1'); closeModal()">‚û°Ô∏è Ir a II.1: Estudio general</button>
          `;
          break;

        case "II1":
          title.textContent = "II.1: Estudio general de la fisiopatolog√≠a por √≥rganos y sistemas";
          body.innerHTML = `
            <p>An√°lisis de la fisiopatolog√≠a desde una perspectiva sist√©mica: cardiovascular, respiratorio, renal, nervioso, digestivo, end√≥crino, etc.</p>
            <p>Se estudian las alteraciones funcionales comunes y espec√≠ficas en cada sistema.</p>
            <button class="btn-next" onclick="unlockNext('II2'); closeModal()">‚û°Ô∏è Siguiente: Marcadores</button>
          `;
          break;

        case "II2":
          title.textContent = "II.2: Identificaci√≥n de marcadores y procesos espec√≠ficos relevantes para el diagn√≥stico cl√≠nico y la investigaci√≥n biom√©dica";
          body.innerHTML = `
            <p>Uso de biomarcadores para diagn√≥stico cl√≠nico y monitoreo de enfermedades.</p>
            <ul class="topic-list">
              <li>Tipos de biomarcadores (gen√©ticos, proteicos, metab√≥licos).</li>
              <li>Aplicaci√≥n en investigaci√≥n biom√©dica.</li>
              <li>Relaci√≥n con procesos fisiopatol√≥gicos espec√≠ficos.</li>
            </ul>
            <button class="btn-next" onclick="unlockNext('III'); closeModal()">‚û°Ô∏è Desbloquear Unidad III</button>
          `;
          break;

        case "III":
          title.textContent = "Unidad III: Enfermeda
